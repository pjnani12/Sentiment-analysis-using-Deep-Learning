loading data...
data loaded!
train_X.shape = (783, 2641)
train_Y.shape = (783, 2)
val_X.shape = (215, 2641)
val_Y.shape = (215, 2)
Epoch 1/1

 50/783 [>.............................] - ETA: 6:07 - loss: 0.6934 - acc: 0.5400
100/783 [==>...........................] - ETA: 5:45 - loss: 0.6942 - acc: 0.5100
150/783 [====>.........................] - ETA: 5:20 - loss: 0.6919 - acc: 0.5400
200/783 [======>.......................] - ETA: 4:56 - loss: 0.6925 - acc: 0.5300
250/783 [========>.....................] - ETA: 4:31 - loss: 0.6922 - acc: 0.5200
300/783 [==========>...................] - ETA: 4:05 - loss: 0.6915 - acc: 0.5333
350/783 [============>.................] - ETA: 3:40 - loss: 0.6912 - acc: 0.5457
400/783 [==============>...............] - ETA: 3:15 - loss: 0.6912 - acc: 0.5600
450/783 [================>.............] - ETA: 2:49 - loss: 0.6903 - acc: 0.5600
500/783 [==================>...........] - ETA: 2:24 - loss: 0.6903 - acc: 0.5520
550/783 [====================>.........] - ETA: 1:58 - loss: 0.6898 - acc: 0.5491
600/783 [=====================>........] - ETA: 1:33 - loss: 0.6887 - acc: 0.5667
650/783 [=======================>......] - ETA: 1:07 - loss: 0.6886 - acc: 0.5600
700/783 [=========================>....] - ETA: 42s - loss: 0.6881 - acc: 0.5671 
750/783 [===========================>..] - ETA: 16s - loss: 0.6878 - acc: 0.5613
783/783 [==============================] - 399s 510ms/step - loss: 0.6874 - acc: 0.5696

 10/215 [>.............................] - ETA: 43s
 20/215 [=>............................] - ETA: 41s
 30/215 [===>..........................] - ETA: 38s
 40/215 [====>.........................] - ETA: 36s
 50/215 [=====>........................] - ETA: 34s
 60/215 [=======>......................] - ETA: 32s
 70/215 [========>.....................] - ETA: 30s
 80/215 [==========>...................] - ETA: 28s
 90/215 [===========>..................] - ETA: 26s
100/215 [============>.................] - ETA: 24s
110/215 [==============>...............] - ETA: 21s
120/215 [===============>..............] - ETA: 19s
130/215 [=================>............] - ETA: 17s
140/215 [==================>...........] - ETA: 15s
150/215 [===================>..........] - ETA: 13s
160/215 [=====================>........] - ETA: 11s
170/215 [======================>.......] - ETA: 9s 
180/215 [========================>.....] - ETA: 7s
190/215 [=========================>....] - ETA: 5s
200/215 [==========================>...] - ETA: 3s
210/215 [============================>.] - ETA: 1s
215/215 [==============================] - 45s 209ms/step
Epoch 0: validation accuracy = 79.070%, validation AUC = 87.665%
Epoch 1/1

 50/783 [>.............................] - ETA: 6:14 - loss: 0.6758 - acc: 0.5600
100/783 [==>...........................] - ETA: 5:48 - loss: 0.6684 - acc: 0.6700
150/783 [====>.........................] - ETA: 5:23 - loss: 0.6650 - acc: 0.6667
200/783 [======>.......................] - ETA: 4:57 - loss: 0.6622 - acc: 0.6450
250/783 [========>.....................] - ETA: 4:32 - loss: 0.6589 - acc: 0.6520
300/783 [==========>...................] - ETA: 4:06 - loss: 0.6564 - acc: 0.6600
350/783 [============>.................] - ETA: 3:41 - loss: 0.6540 - acc: 0.6800
400/783 [==============>...............] - ETA: 3:15 - loss: 0.6495 - acc: 0.6900
450/783 [================>.............] - ETA: 2:50 - loss: 0.6459 - acc: 0.7067
500/783 [==================>...........] - ETA: 2:24 - loss: 0.6442 - acc: 0.7120
550/783 [====================>.........] - ETA: 1:58 - loss: 0.6393 - acc: 0.7273
600/783 [=====================>........] - ETA: 1:33 - loss: 0.6407 - acc: 0.7117
650/783 [=======================>......] - ETA: 1:07 - loss: 0.6382 - acc: 0.7138
700/783 [=========================>....] - ETA: 42s - loss: 0.6369 - acc: 0.7057 
750/783 [===========================>..] - ETA: 16s - loss: 0.6336 - acc: 0.7133
783/783 [==============================] - 400s 511ms/step - loss: 0.6306 - acc: 0.7126

 10/215 [>.............................] - ETA: 42s
 20/215 [=>............................] - ETA: 40s
 30/215 [===>..........................] - ETA: 38s
 40/215 [====>.........................] - ETA: 36s
 50/215 [=====>........................] - ETA: 34s
 60/215 [=======>......................] - ETA: 32s
 70/215 [========>.....................] - ETA: 30s
 80/215 [==========>...................] - ETA: 28s
 90/215 [===========>..................] - ETA: 26s
100/215 [============>.................] - ETA: 23s
110/215 [==============>...............] - ETA: 21s
120/215 [===============>..............] - ETA: 19s
130/215 [=================>............] - ETA: 17s
140/215 [==================>...........] - ETA: 15s
150/215 [===================>..........] - ETA: 13s
160/215 [=====================>........] - ETA: 11s
170/215 [======================>.......] - ETA: 9s 
180/215 [========================>.....] - ETA: 7s
190/215 [=========================>....] - ETA: 5s
200/215 [==========================>...] - ETA: 3s
210/215 [============================>.] - ETA: 1s
215/215 [==============================] - 45s 208ms/step
Epoch 1: validation accuracy = 84.186%, validation AUC = 88.947%
Epoch 1/1

 50/783 [>.............................] - ETA: 6:14 - loss: 0.5494 - acc: 0.8000
100/783 [==>...........................] - ETA: 5:48 - loss: 0.5601 - acc: 0.7700
150/783 [====>.........................] - ETA: 5:22 - loss: 0.5481 - acc: 0.8000
200/783 [======>.......................] - ETA: 4:57 - loss: 0.5303 - acc: 0.8300
250/783 [========>.....................] - ETA: 4:32 - loss: 0.5295 - acc: 0.8280
300/783 [==========>...................] - ETA: 4:06 - loss: 0.5180 - acc: 0.8333
350/783 [============>.................] - ETA: 3:40 - loss: 0.5129 - acc: 0.8457
400/783 [==============>...............] - ETA: 3:15 - loss: 0.5048 - acc: 0.8450
450/783 [================>.............] - ETA: 2:49 - loss: 0.4992 - acc: 0.8422
500/783 [==================>...........] - ETA: 2:24 - loss: 0.4965 - acc: 0.8340
550/783 [====================>.........] - ETA: 1:58 - loss: 0.4909 - acc: 0.8345
600/783 [=====================>........] - ETA: 1:33 - loss: 0.4850 - acc: 0.8367
650/783 [=======================>......] - ETA: 1:07 - loss: 0.4841 - acc: 0.8292
700/783 [=========================>....] - ETA: 42s - loss: 0.4800 - acc: 0.8286 
750/783 [===========================>..] - ETA: 16s - loss: 0.4728 - acc: 0.8293
783/783 [==============================] - 399s 510ms/step - loss: 0.4646 - acc: 0.8340

 10/215 [>.............................] - ETA: 42s
 20/215 [=>............................] - ETA: 40s
 30/215 [===>..........................] - ETA: 38s
 40/215 [====>.........................] - ETA: 36s
 50/215 [=====>........................] - ETA: 34s
 60/215 [=======>......................] - ETA: 32s
 70/215 [========>.....................] - ETA: 30s
 80/215 [==========>...................] - ETA: 28s
 90/215 [===========>..................] - ETA: 26s
100/215 [============>.................] - ETA: 24s
110/215 [==============>...............] - ETA: 21s
120/215 [===============>..............] - ETA: 19s
130/215 [=================>............] - ETA: 17s
140/215 [==================>...........] - ETA: 15s
150/215 [===================>..........] - ETA: 13s
160/215 [=====================>........] - ETA: 11s
170/215 [======================>.......] - ETA: 9s 
180/215 [========================>.....] - ETA: 7s
190/215 [=========================>....] - ETA: 5s
200/215 [==========================>...] - ETA: 3s
210/215 [============================>.] - ETA: 1s
215/215 [==============================] - 45s 209ms/step
Epoch 2: validation accuracy = 86.512%, validation AUC = 91.502%
3 epochs passed
Accuracy on validation dataset:
[0.7906976744186046, 0.8418604651162791, 0.8651162790697674]
AUC on validation dataset:
[0.8766458766458767, 0.8894663894663895, 0.9150207900207901]
test_X.shape = (39, 2641)
Help on module Train+testing_CNN:

NAME
    Train+testing_CNN - Created on Fri Mar  9 15:23:03 2018

FILE
    /home/peddisubbi1/Train+testing_CNN.py

DESCRIPTION
    @author: Jagadeesh Panthati

FUNCTIONS
    get_idx_from_sent(sent, word_idx_map, max_l=51, kernel_size=5)
        all the sentences doesnot have same size(number of words), so we pad with zeros.
        took max length of sentance is 51.
        Transforms sentence into a list of indices. Pad with zeroes.
    
    make_idx_data(revs, word_idx_map, max_l=51, kernel_size=5)
        Transforms sentences into a 2-d matrix.

DATA
    N = 783
    N_epoch = 3
    N_fm = 300
    Nt = 39
    Nv = 215
    W = array([[ 0.        ,  0.        ,  0.        , ....        0.08984...
    __warningregistry__ = {('Update your `Conv2D` call to the Keras 2 API:...
    conv_input_height = 2641
    conv_input_width = 300
    datasets = [array([[0, 0, 0, ..., 0, 0, 0],
           [0, 0, 0,..., ..., ...
    epoch = 3
    i = 38
    j = 2640
    kernel_size = 8
    model = <keras.models.Sequential object>
    opt = <keras.optimizers.Adadelta object>
    output = array([[0.01819034, 0.9818096 ],
           [0.64109...
           [0...
    revs = [{'num_words': 21, 'split': 1, 'text': 'so there is no way for ...
    t = 0.99
    test_X = array([[0, 0, 0, ..., 0, 0, 0],
           [0, 0, 0,..., ..., 0, ...
    train_X = array([[0, 0, 0, ..., 0, 0, 0],
           [0, 0, 0,..., ..., 0,...
    train_Y = array([[1, 0],
           [0, 1],
           [0, 1],
       .....,
         ...
    vacc = 0.8651162790697674
    val_X = array([[0, 0, 0, ..., 0, 0, 0],
           [0, 0, 0,..., ..., 0, 0...
    val_Y = array([[0, 1],
           [1, 0],
           [0, 1],
       ...1],
           ...
    val_acc = [0.7906976744186046, 0.8418604651162791, 0.8651162790697674]
    val_auc = [0.8766458766458767, 0.8894663894663895, 0.9150207900207901]
    vauc = 0.9150207900207901
    vocab = defaultdict(<type 'float'>, {'magnetic': 1.0, 's... 1.0, 'yell...
    word_idx_map = {'!': 1033, "'d": 448, "'ll": 1841, "'re": 1369, "'s": ...
    x = [[{'num_words': 21, 'split': 1, 'text': 'so there is no way for me...


